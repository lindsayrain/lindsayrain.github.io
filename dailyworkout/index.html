<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»Šå¤©é‹å‹•äº†å—ï¼Ÿ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        @keyframes sad-shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-3deg); }
            50% { transform: translateX(5px) rotate(3deg); }
            75% { transform: translateX(-5px) rotate(-3deg); }
        }
        .animate-sad-shake {
            animation: sad-shake 0.5s ease-in-out;
        }
        .hover-scale:hover {
            transform: scale(1.05);
            transition: transform 0.2s ease-in-out;
        }
        #emoji-display {
            font-size: 6rem;
            line-height: 1;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.3s ease-in-out;
        }
        #emoji-display:hover {
             transform: scale(1.1);
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-100 to-blue-100 flex flex-col items-center justify-center min-h-screen p-6">

    <div id="app" class="bg-white rounded-lg shadow-xl p-8 max-w-md w-full text-center transition-all duration-500">
        <div id="message-area" class="mb-8">
             <div id="emoji-display" class="mx-auto"></div>
            <p id="message" class="text-xl font-semibold text-gray-700"></p>
            <p id="sub-message" class="text-sm text-gray-500 mt-2"></p>
        </div>

        <div class="space-y-4">
            <button id="log-exercise-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-colors duration-300 hover-scale w-full">
                æˆ‘ä»Šå¤©é‹å‹•è¶…é 30 åˆ†é˜äº†ï¼ğŸ’ª
            </button>

            <button id="remind-again-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors duration-300 hover-scale w-full hidden">
                è«‹ç¹¼çºŒæé†’æˆ‘...ğŸ¥º
            </button>
        </div>

        <p id="last-exercise-time" class="text-xs text-gray-400 mt-6"></p>
    </div>

    <script>
        // --- DOM å…ƒç´  ---
        const messageArea = document.getElementById('message-area');
        const emojiDisplay = document.getElementById('emoji-display');
        const messageElement = document.getElementById('message');
        const subMessageElement = document.getElementById('sub-message');
        const logExerciseBtn = document.getElementById('log-exercise-btn');
        const remindAgainBtn = document.getElementById('remind-again-btn');
        const lastExerciseTimeElement = document.getElementById('last-exercise-time');
        const appElement = document.getElementById('app');

        // --- ç‹€æ…‹å’Œè¨Šæ¯ ---
        const today = new Date().toLocaleDateString();
        let lastExerciseDate = localStorage.getItem('lastExerciseDate');
        let forceRemind = sessionStorage.getItem('forceRemind') === 'true';

        // --- Emoji åº« ---
        const guiltEmojis = ['ğŸ˜', 'ğŸ˜¢', 'ğŸ˜ ', 'ğŸ¥º', 'ğŸ˜©', 'ğŸ’”', 'ğŸ˜¥', 'ğŸ˜­', 'ğŸ‘€'];
        const successEmojis = ['ğŸ¥³', 'ğŸ‰', 'ğŸ¤©', 'ğŸ¥°', 'ğŸ‘', 'ğŸ’¯', 'âœ¨', 'ğŸ’ª', 'ğŸŒŸ'];

        // --- è¨Šæ¯åº« ---
        const guiltMessages = [
            { msg: "ä½ ç¢ºå®šä¸å†å¤šå‹•ä¸€ä¸‹å—ï¼Ÿ", sub: "å†å …æŒä¸€ä¸‹ä¸‹å˜›..." },
            { msg: "å¥½å§ï¼Œæ—¢ç„¶ä½ è¦æ±‚...", sub: "é‹å‹•ä¸å¤ ï¼Œè´…è‚‰æœƒç¬‘å–”ã€‚" },
            { msg: "ç›¯......", sub: "æˆ‘æœƒä¸€ç›´çœ‹è‘—ä½ çš„ã€‚" },
            { msg: "ä¼‘æ¯å¤ äº†å—ï¼Ÿæ˜¯ä¸æ˜¯è©²èµ·ä¾†å‹•å‹•äº†ï¼Ÿ", sub: "æ²™ç™¼é¦¬éˆ´è–¯è­¦å‘Šï¼ğŸ¥”" },
            { msg: "æˆ‘çŸ¥é“ä½ é‹å‹•äº†ï¼Œä½†é‚„å¯ä»¥æ›´å¥½ï¼", sub: "è¶…è¶Šæ˜¨å¤©çš„è‡ªå·±ï¼(ç‰©ç†)" }
        ];
        const originalSuccessMessages = [
            { msg: "å¤ªæ£’äº†ï¼æˆ‘å°±çŸ¥é“ä½ åšå¾—åˆ°ï¼", sub: "ç‚ºä½ æ„Ÿåˆ°é©•å‚²ï¼æ˜å¤©ä¹Ÿè¦ç¹¼çºŒå–”ï¼" },
            { msg: "ä»Šå¤©çš„ä½ é–ƒé–ƒç™¼å…‰ï¼", sub: "æ±—æ°´æ˜¯æœ€å¥½çš„è£é£¾å“ï¼" },
            { msg: "åšå¾—å¥½ï¼ä¿æŒä¸‹å»ï¼", sub: "å¥åº·çš„ç”Ÿæ´»æ–¹å¼æ­£åœ¨å‘ä½ æ‹›æ‰‹ï¼" }
        ];

        // --- åŠŸèƒ½å‡½æ•¸ ---
        function updateDisplay(messages, emojis) {
            const randomMsgIndex = Math.floor(Math.random() * messages.length);
            const selectedMessage = messages[randomMsgIndex];
            messageElement.textContent = selectedMessage.msg;
            subMessageElement.textContent = selectedMessage.sub;
            const randomEmojiIndex = Math.floor(Math.random() * emojis.length);
            emojiDisplay.textContent = emojis[randomEmojiIndex];
        }

        function checkExerciseStatus() {
            lastExerciseDate = localStorage.getItem('lastExerciseDate');
            const isExercisedToday = lastExerciseDate === today;

            if (forceRemind && isExercisedToday) {
                // æƒ…æ³ 1: ä»Šå¤©å·²é‹å‹•ï¼Œä½†ç”¨æˆ¶è¦æ±‚ç¹¼çºŒæé†’
                updateDisplay(guiltMessages, guiltEmojis);
                // *** ä¿®æ”¹é–‹å§‹ ***
                // è®“ä¸»è¦æŒ‰éˆ•å¯ä»¥å†æ¬¡é»æ“Š
                logExerciseBtn.textContent = 'æˆ‘ä»Šå¤©é‹å‹•è¶…é 30 åˆ†é˜äº†ï¼ğŸ’ª'; // æ¢å¾©æŒ‰éˆ•æ–‡å­—
                logExerciseBtn.disabled = false; // å•Ÿç”¨æŒ‰éˆ•
                logExerciseBtn.classList.remove('bg-gray-400', 'cursor-not-allowed'); // ç§»é™¤ç¦ç”¨æ¨£å¼
                logExerciseBtn.classList.add('bg-green-500', 'hover:bg-green-600'); // åŠ å›å•Ÿç”¨æ¨£å¼
                // *** ä¿®æ”¹çµæŸ ***
                remindAgainBtn.classList.add('hidden');
                appElement.classList.remove('from-green-100', 'to-emerald-100');
                appElement.classList.add('from-yellow-100', 'to-orange-100');
                messageArea.classList.add('animate-sad-shake');
                 setTimeout(() => {
                        messageArea.classList.remove('animate-sad-shake');
                    }, 500);

            } else if (isExercisedToday) {
                // æƒ…æ³ 2: ä»Šå¤©å·²é‹å‹•ï¼Œæ­£å¸¸é¡¯ç¤ºæˆåŠŸè¨Šæ¯
                updateDisplay(originalSuccessMessages, successEmojis);
                logExerciseBtn.textContent = 'ä»Šå¤©å·²å®Œæˆï¼æ˜å¤©å†ä¾†ï¼';
                logExerciseBtn.disabled = true; // ç¦ç”¨æŒ‰éˆ•
                logExerciseBtn.classList.remove('bg-green-500', 'hover:bg-green-600'); // ç§»é™¤å•Ÿç”¨æ¨£å¼
                logExerciseBtn.classList.add('bg-gray-400', 'cursor-not-allowed'); // åŠ å›ç¦ç”¨æ¨£å¼
                remindAgainBtn.classList.remove('hidden');
                appElement.classList.remove('from-red-100', 'to-orange-100', 'from-yellow-100');
                appElement.classList.add('from-green-100', 'to-emerald-100');
                messageArea.classList.remove('animate-sad-shake');

            } else {
                // æƒ…æ³ 3: ä»Šå¤©å°šæœªé‹å‹•
                updateDisplay(guiltMessages, guiltEmojis);
                logExerciseBtn.textContent = 'æˆ‘ä»Šå¤©é‹å‹•è¶…é 30 åˆ†é˜äº†ï¼ğŸ’ª';
                logExerciseBtn.disabled = false; // å•Ÿç”¨æŒ‰éˆ•
                logExerciseBtn.classList.add('bg-green-500', 'hover:bg-green-600'); // ç¢ºä¿å•Ÿç”¨æ¨£å¼
                logExerciseBtn.classList.remove('bg-gray-400', 'cursor-not-allowed'); // ç§»é™¤ç¦ç”¨æ¨£å¼
                remindAgainBtn.classList.add('hidden');
                appElement.classList.remove('from-green-100', 'to-emerald-100', 'from-yellow-100');
                appElement.classList.add('from-red-100', 'to-orange-100');
                if (Math.random() < 0.3) {
                    messageArea.classList.add('animate-sad-shake');
                    setTimeout(() => {
                        messageArea.classList.remove('animate-sad-shake');
                    }, 500);
                }
            }

            if (lastExerciseDate) {
                lastExerciseTimeElement.textContent = `ä¸Šæ¬¡é‹å‹•ç´€éŒ„ï¼š${lastExerciseDate}`;
            } else {
                lastExerciseTimeElement.textContent = 'é‚„æ²’æœ‰é‹å‹•ç´€éŒ„å–”ï¼Œå¿«é–‹å§‹å§ï¼';
            }
        }

        function handleLogExercise() {
            const now = new Date();
            localStorage.setItem('lastExerciseDate', now.toLocaleDateString());
            forceRemind = false;
            sessionStorage.removeItem('forceRemind');
            checkExerciseStatus();
        }

        function handleRemindAgain() {
            forceRemind = true;
            sessionStorage.setItem('forceRemind', 'true');
            checkExerciseStatus();
        }

        // --- äº‹ä»¶ç›£è½ ---
        logExerciseBtn.addEventListener('click', handleLogExercise);
        remindAgainBtn.addEventListener('click', handleRemindAgain);

        // --- åˆå§‹åŒ– ---
        checkExerciseStatus();

    </script>

</body>
</html>
